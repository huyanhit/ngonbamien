document.getElementById("scroll-top");const c=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}),m={id:0,quantity:1,option_id:null,options:{}};let o=null;window.onscroll=function(){h(),_()};p();function h(){const t=document.getElementById("box-contain"),e=document.getElementById("box-tv");if(t!==null&&e!==null){const n=t.offsetTop-100,a=t.offsetHeight+t.offsetTop-e.offsetHeight-100;window.pageYOffset>n&&window.pageYOffset<a?(t.classList.add("top"),t.classList.remove("bot")):window.pageYOffset>a?(t.classList.add("bot"),t.classList.remove("top")):(t.classList.remove("bot"),t.classList.remove("top"))}}function _(){let t=document.getElementById("header__bot");document.onscroll=function(){if(t!==null){let e=t.offsetTop+100;window.pageYOffset>e?t.classList.add("sticky"):t.classList.remove("sticky")}}}function p(){o==null?$.ajax({type:"GET",url:"/cart",contentType:"application/json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(t){o=t,d()}):setTimeout(function(){d()},10)}function v(){return p(),'<div> <h4 class="text-center mb-2 text-uppercase"><b>Giỏ hàng</b><a id="close-cart" class="btn btn-sm btn-danger pull-right text-white"><i class="fa fa-close"></i></a></div><div class="my-cart">Loading...</div><div class="text-center mb-2"><a href="/gio-hang" class="btn px-3 btn-info text-uppercase text-white mr-2"><i class="bi bi-x-circle"></i> Nhập mã giảm giá </a><a class="btn px-3 btn-success text-uppercase" href="/dat-hang"><i class="bi bi-cart"></i> Đặt hàng </a></div></div>'}function d(){let t='<table class="table bg-light"><tr class="background_pr text-white"><th width="10%" class="text-center">Hình ảnh</th><th width="20%">Tên sản phẩm</th><th width="10%" class="text-center">Giá</th><th width="20%" class="text-center">Phân loại</th><th width="10%" class="text-center">Số lượng</th><th width="10%" class="text-center">Tổng cộng</th><th width="5%" class="text-center">Xoá</th></tr>',e=o.items;if(Object.keys(e).length>0)for(const a in e){let r="",l=e[a].options;l.title&&(r=l.title),t+='<tr class="align-middle"><td class="text-center"><a href="'+e[a].extra_info.link+'"><img alt="'+e[a].title+`" onerror="this.src='/images/no-image.png'" src="/admin/get-image-thumbnail/`+e[a].extra_info.image_id+'"/><a></td><td class="align-middle"><a class="d-block text-dark" href="'+e[a].extra_info.link+'">'+e[a].title+'</a></td><td class="text-center align-middle text-danger">'+c.format(e[a].price)+' </td><td class="text-center align-middle">'+r+'</td><td class="text-center align-middle"><input class="form-control update_quantity"data-value="'+e[a].hash+'" type="number" value="'+e[a].quantity+'"></td><td class="text-center align-middle">'+c.format(e[a].price*e[a].quantity)+'</td><td class="text-center align-middle"><a class="btn btn-outline-danger btn-sm text-danger remove-cart" data-value="'+e[a].hash+'"><i class="fa fa-minus"></i></a></td></tr>'}else t+='<tr class="align-middle"><td class="text-center p-2" colspan="7">Không có sản phẩm.</td></tr>';t+='<tr class="font-bold background_pr text-white"><td class="text-left" colspan="2"><h5 class="text-uppercase pt-1">Tổng cộng</h4></td><td></td><td></td><td class="text-center"><h4 class="text-bold">'+o.quantities_sum+'</h4></td><td class="text-center"><h4 class="text-bold">'+c.format(o.subtotal)+"</h4></td><td></td></tr>",t+="</table>";let n=$("#coupon-down").attr("data-value");$(".my-cart").html(t),$(".total-pill").html(c.format(o.total)),$("#cart-number").html(o.quantities_sum),$("#coupon-down").html("-"+c.format(n)),$("#total-check").html(c.format(o.total-(n?parseInt(n):0)))}function g(t,e){$.ajax({type:"PUT",url:"/cart/"+e,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{quantity:$(t).val()}}).done(function(n){o=n,d()})}function b(t){confirm("Xóa sản phẩm khỏi giỏ hàng?")&&$.ajax({type:"DELETE",url:"/cart/"+t,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(e){o=e,d()})}function x(t,e,n=""){m.id=e.id,m.option_id=e.option;let a=$(t).html();$(t).html('<div class="spinner-border" style="height: 18px; width: 18px;"></div>'),$.ajax({type:"POST",url:"/cart",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:m}).done(function(r){$(t).html(a),o=r,d(),n!==""&&(window.location.href=n)}).fail(function(){$(t).html(a)})}function f(t,e){if(t.offset()&&e.offset()){let n=6,a=$(t).clone();$(a).css({position:"absolute",top:$(t).offset().top+"px",left:$(t).offset().left+"px",opacity:1,"z-index":1e3}),$("body").append($(a));let r=$(e).offset().left+$(e).width()/2-$(t).width()/n/2,l=$(e).offset().top+$(e).height()/2-$(t).height()/n/2;$(a).animate({opacity:.4,left:r,top:l,width:$(t).width()/n,height:$(t).height()/n},700,function(){$(e).fadeOut("fast",function(){$(e).fadeIn("fast",function(){$(a).fadeOut("fast",function(){$(a).remove()})})})})}}function w(t,e){$(t).html('<div class="spinner-border" style="height: 18px; width: 18px;"></div>'),$.ajax({type:"POST",url:"/favor",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:e}).done(function(n){if($(t).html('<i class="fa fa-heart text-danger"></i>'),n.total){let a=$(t).parents(".featured__item__pic").find("img").eq(0);f($(a),$(".favor_anchor")),$("#favor_count").html(n.total)}})}function y(t,e){return!1}$(document).ready(function(){$(document).on("click","#close-cart",function(){$("#popover_cart").popover("hide")}),$("#popover_cart").popover({html:!0,container:".cart-container",offset:"0 0",content:function(){return v()}}),$("#popover_notify").popover({html:!0,container:".notify-container",offset:"0 0",content:function(){return"Phiên bản 1.0 release 01/06/2025"}}),$(".dropdown-auth").click(function(){$(".auth-container").toggleClass("active")}),$("#slider").nivoSlider({effect:"fade",animSpeed:2e3,pauseTime:4e3,startSlide:0,directionNav:!1,controlNav:!1,controlNavThumbs:!1,pauseOnHover:!1}),$(".service-carousel").owlCarousel({loop:!0,margin:10,dots:!1,responsive:{0:{items:1},600:{items:2},1e3:{items:4}}}),$(".product-carousel").owlCarousel({loop:!0,margin:0,dots:!1,responsive:{0:{items:1},900:{items:2},1e3:{items:3},1200:{items:5}}}),$(".customer-carousel").owlCarousel({loop:!0,dots:!1,margin:0,responsive:{0:{items:2},600:{items:4},1e3:{items:6}}}),$(".select_price_option").click(function(){let i=$(this).attr("data-value");$(".select_price_option").removeClass("active"),$(".product_detail_option").removeClass("active"),$(".product_detail_"+i).addClass("active"),$(".select_price_"+i).addClass("active")}),$(".filter__option_ul").on("click",function(){$(this).addClass("active"),$(".filter__list").addClass("active"),$(".filter__option_grid").removeClass("active")}),$(".filter__option_grid").on("click",function(){$(this).addClass("active"),$(".filter__list").removeClass("active"),$(".filter__option_ul").removeClass("active")}),$(".add_cart").on("click",function(i){i.preventDefault();let s=$(this).parents(".featured__item__pic").find("img").eq(0);f($(s),$(".cart_anchor")),x(this,{id:$(this).attr("data-value"),option:$(this).attr("option-value")},$(this).attr("data-link")??"")}),$(".add_favor").on("click",function(i){i.preventDefault(),w(this,{id:$(this).attr("data-value")})}),$(".as_message").on("click",function(i){i.preventDefault(),y(this,{id:$(this).attr("data-value")})}),$(".cart-container").on("click",".remove-cart",function(i){i.preventDefault(),b($(this).attr("data-value"))}),$(".cart-container").on("blur",".update_quantity",function(i){i.preventDefault(),g(this,$(this).attr("data-value"))}),$(".product__item__price").on("click",function(i){$(this).parent().find(".product__item__price").addClass("hide"),$(this).parents(".featured__item").find(".add_cart").attr("option-value",$(this).attr("data-value")),$(this).removeClass("hide")}),$("#pay_cod").click(function(){$("#pay_store_form").hide(),$("#pay_bank_form").hide(),$("#pay_cod_form").show()}),$("#pay_store").click(function(){$("#pay_cod_form").hide(),$("#pay_bank_form").hide(),$("#pay_store_form").show()}),$("#pay_bank").click(function(){$("#pay_cod_form").hide(),$("#pay_store_form").hide(),$("#pay_bank_form").show()}),$(".show-more").click(function(i){i.preventDefault(),$(i).toggleClass("active"),$(".producer_blog").toggleClass("active")}),$(window).on("load",function(){if($(".loader").fadeOut(),$("#preloder").delay(200).fadeOut("slow"),$(".featured__controls li").on("click",function(){$(".featured__controls li").removeClass("active"),$(this).addClass("active")}),$(".featured__filter").length>0){var i=document.querySelector(".featured__filter");mixitup(i)}}),$(".set-bg").each(function(){let i=$(this).data("setbg");$(this).css("background-image","url("+i+")")}),$(".humberger__open").on("click",function(){$(".humberger__menu__wrapper").addClass("show__humberger__menu__wrapper"),$(".humberger__menu__overlay").addClass("active"),$("body").addClass("over_hid")}),$(".humberger__menu__overlay").on("click",function(){$(".humberger__menu__wrapper").removeClass("show__humberger__menu__wrapper"),$(".humberger__menu__overlay").removeClass("active"),$("body").removeClass("over_hid")}),$(".mobile-menu").slicknav({prependTo:"#mobile-menu-wrap",allowParentLinks:!0,showChildren:!0,openedSymbol:""}),$(".categories__slider").owlCarousel({loop:!0,margin:0,items:4,dots:!1,nav:!0,navText:["<span class='fa fa-angle-left'><span/>","<span class='fa fa-angle-right'><span/>"],animateOut:"fadeOut",animateIn:"fadeIn",smartSpeed:1200,autoHeight:!1,autoplay:!0,responsive:{0:{items:1},480:{items:2},768:{items:3},992:{items:4}}}),$(".hero__categories__all").on("click",function(){$(".hero__categories ul").slideToggle(400)}),$(".latest-product__slider").owlCarousel({loop:!0,margin:0,items:1,dots:!1,nav:!0,navText:["<span class='fa fa-angle-left'><span/>","<span class='fa fa-angle-right'><span/>"],smartSpeed:1200,autoHeight:!1,autoplay:!1}),$(".product__discount__slider").owlCarousel({loop:!0,margin:0,items:3,dots:!1,smartSpeed:1200,autoHeight:!1,autoplay:!0,responsive:{320:{items:1},480:{items:2},768:{items:2},992:{items:3}}}),$(".product__details__pic__slider").owlCarousel({loop:!0,margin:20,items:4,dots:!0,smartSpeed:1200,autoHeight:!1,autoplay:!0});var t=$(".price-range"),e=$("#minamount"),n=$("#maxamount"),a=t.data("min"),r=t.data("max");t.slider({range:!0,min:a,max:r,values:[a,r],slide:function(i,s){e.val(s.values[0]+"k"),n.val(s.values[1]+"k")}}),e.val(t.slider("values",0)+"k"),n.val(t.slider("values",1)+"k"),$("select").niceSelect(),$(".product__details__pic__slider img").on("click",function(){var i=$(this).data("imgbigurl"),s=$(".product__details__pic__item--large").attr("src");i!=s&&$(".product__details__pic__item--large").attr({src:i})});var l=$(".pro-qty");l.prepend('<span class="dec qtybtn">-</span>'),l.append('<span class="inc qtybtn">+</span>'),l.on("click",".qtybtn",function(){var i=$(this),s=i.parent().find("input").val();if(i.hasClass("inc"))var u=parseFloat(s)+1;else if(s>0)var u=parseFloat(s)-1;else u=0;i.parent().find("input").val(u)})});
